---
title: "GROUP 10 SIMULATION"
author: "Shriya, Vivaan, Luke"
date: "2024-07-14"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
``` 

```{r}
library(tidyverse)
library(here)
library(lubridate)
library(ratdat)
library(ggplot2)
```

Competition: 

```{r}
n = 50

coral.simu1 = rep(NaN, n)

#assigns the first value in vector to 100
coral.simu1[1] <- 200 #exp.simu5
coral.simu1[1]

r1 = 1.0215 #coral growth rate
K1 = 1000

algae.simu1 = rep(NaN, n)
#assigns the first value in vector to 100
algae.simu1[1] <- 50 #exp.simu6
algae.simu1[1]

r2 = 1.025
K2 = 10000
```

```{r}
delta_t <- 1
alpha1 <- 0.3 # effect of coral on algae
beta1 <- -0.3 # effect of algae on coral

sim_df1 <- data.frame(t = 1:n)

for(i in 2:length(coral.simu1)) {
  delta_N1 <- (coral.simu1[i-1] *r1) *((K1-coral.simu1[i-1]+(algae.simu1[i-1]*beta1))/ K1) * delta_t
  coral.simu1[i] <- coral.simu1[i-1] + delta_N1
  
  delta_N2 <- (algae.simu1[i-1] *r2) *((K2-algae.simu1[i-1]+(coral.simu1[i-1]*alpha1))/ K2) * delta_t
  algae.simu1[i] <- algae.simu1[i-1] + delta_N2
}

coral.simu1
print("----------------------------------------------------------")
algae.simu1

sim_df1$coral = coral.simu1
sim_df1$algae = algae.simu1

sim_df_tidy1 <- sim_df1 %>% 
  pivot_longer(cols = coral:algae,
               names_to = "Species",
               values_to = "pop_size")

#together (legend)
ggplot(sim_df_tidy1, aes(color = Species)) +
  geom_point(aes(x = t, y = pop_size)) +
  geom_line(aes(x = t , y = pop_size), linetype = "dashed") + 
  theme_minimal() +
  labs(x = "Time (years)",
       y = "Population Size")

#enhanced (legend)
ggplot(sim_df_tidy1, aes(color = Species)) +
  geom_point(aes(x = t, y = pop_size)) +
  geom_line(aes(x = t , y = pop_size), linetype = "dashed") + 
  theme_minimal() +
  labs(x = "Time (years)",
       y = "Population Size") +
  xlim(0,10)
```
```{r}
mean_coral <- 0
for (i in 25:length(coral.simu1)) {
  mean_coral = mean_coral + coral.simu1[i]
}
mean_coral = mean_coral / 25

mean_algae <- 0
for (i in 25:length(algae.simu1)) {
  mean_algae = mean_algae + algae.simu1[i]
}
mean_algae = mean_algae / 25

mean_equilibrium <- c(mean_coral, mean_algae)

species_list <- c("Coral", "Algae")

data <- data.frame(species_list, mean_equilibrium)

ggplot(data) +
  geom_col(aes(x = species_list, y = mean_equilibrium, fill = species_list)) +
  theme_bw() +
  labs(x = "Species",
       y = "Equilibrium Population") +
  scale_y_log10()
```


```{r}
coral.simu2 = rep(NaN, n)
#assigns the first value in vector to 100
coral.simu2[1] <- 500
coral.simu2[1]

r3 = 1.0215
K3 = 1000

algae.simu2 = rep(NaN, n)
#assigns the first value in vector to 100
algae.simu2[1] <- 50
algae.simu2[1]

r4 = 1.025
K4 = 10000

pfish.simu2 = rep(NaN, n)
#assigns the first value in vector to 100
pfish.simu2[1] <- 2000
pfish.simu2[1]

r5 = 1.1
K5 = 13700
```

```{r}
delta_t <- 1

alpha1 <- -0.3 # effect of coral on algae
alpha2 <- 0.5 # coral on pfish
beta1 <- -0.3 # effect of algae on coral
beta2 <- 0.8 # algae on pfish
gamma1 <- -0.5 # pfish on coral
gamma2 <- -0.8 # pfish on algae

sim_df <- data.frame(t = 1:n)

for(i in 2:length(coral.simu2)) {
  
  deltaN1 <- (coral.simu2[i-1] * r3) * ( (K3 - coral.simu2[i-1] + (algae.simu2 * beta1) + (pfish.simu2 * gamma1)) / K3) * delta_t
  coral.simu2[i] <- coral.simu2[i-1] + deltaN1

  deltaN2 <- (algae.simu2[i-1] * r4) * ( (K4 - algae.simu2[i-1] + (coral.simu2 * alpha1) + (pfish.simu2 * gamma2)) / K4) * delta_t
  algae.simu2[i] <- algae.simu2[i-1] + deltaN2

  deltaN3 <- (pfish.simu2[i-1] * r5) * ( (K5 - pfish.simu2[i-1] + (coral.simu2 * alpha2) + (algae.simu2 * beta2)) / K5) * delta_t
  pfish.simu2[i] <- pfish.simu2[i-1] + deltaN3
  
}

coral.simu2
print("-------------------------------------------------------------")
algae.simu2
print("-------------------------------------------------------------")
pfish.simu2

sim_df$coral = coral.simu2
sim_df$algae = algae.simu2
sim_df$pfish = pfish.simu2

sim_df_tidy <- sim_df %>% 
  pivot_longer(cols = coral:pfish,
               names_to = "Species",
               values_to = "pop_size")

#all three (legend)
ggplot(sim_df_tidy, aes(color = Species)) +
  geom_point(aes(x = t, y = pop_size)) +
  geom_line(aes(x = t , y = pop_size), linetype = "dashed") + 
  theme_minimal() +
  labs(x = "Time (years)",
       y = "Population Size")

#enhanced (legend)
ggplot(sim_df_tidy, aes(color = Species)) +
  geom_point(aes(x = t, y = pop_size)) +
  geom_line(aes(x = t , y = pop_size), linetype = "dashed") + 
  theme_minimal() +
  labs(x = "Time (years)",
       y = "Population Size") +
  xlim(01 , 10)
```

```{r}
mean_coral <- 0
for (i in 25:length(coral.simu2)) {
  mean_coral = mean_coral + coral.simu2[i]
}
mean_coral = mean_coral / 25

mean_algae <- 0
for (i in 25:length(algae.simu2)) {
  mean_algae = mean_algae + algae.simu2[i]
}
mean_algae = mean_algae / 25

mean_pfish <- 0
for (i in 25:length(pfish.simu2)) {
  mean_pfish = mean_pfish + pfish.simu2[i]
}

mean_equilibrium <- c(mean_coral, mean_algae, mean_pfish)

species_list <- c("Coral", "Algae", "Parrotfish")

data <- data.frame(species_list, mean_equilibrium)

ggplot(data) +
  geom_col(aes(x = species_list, y = mean_equilibrium, fill = species_list)) +
  theme_bw() +
  labs(x = "Species",
       y = "log of Equilibrium Population") +
  scale_y_log10()
```

